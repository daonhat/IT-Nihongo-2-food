<div class="posts-wrapper">
  <div class="post">
    <div class="post-body">
      <div class="image-wrap container-food-upload">
        <%= form_for(food) do |f| %>
          <div class="container-fluid">
            <% if food.persisted? %>
              <h3><%= t :edit_food %> <%= food.name %></h3>
            <% else %>
              <h3><%= t "upload_your_food"%></h3>
            <% end %>
            <div class="form-group">
              <%= f.label t(:name_of_food) %>
              <%= f.text_field :name, class: "form-control form-food",
                placeholder: t(:name_of_food) %>
              <%= genError food, :name %>
            </div>
            <div class="form-group">
              <%= f.label t(:address) %>
              <%= f.text_field :address, class: "form-control form-food",
                placeholder: t(:address_of_food) %>
              <%= genError food, :address %>
            </div>

            <div class="form-group">
              <%= f.label t(:caption) %>
              <%= f.text_area :caption, class: "form-control form-food",
                placeholder: t(:caption_of_food) %>
              <%= genError food, :caption %>
            </div>
            <div class="form-group">
              <%= image_tag food.picture_url,
                class: "hidden picture-of-food", data: {filename: food.picture.file.identifier,
                size: food.picture.size} if food.persisted? %>

              <%= f.label t(:picture) %>
              <%= f.file_field :picture, accept: "image/jpeg,image/gif,image/png",
                class: "form-control" %>

              <%= f.hidden_field :picture_flag, value: 1 %>
              <%= genError food, :picture %>
              <%= genError_p(@errors) if @errors.present? %>
            </div>
            <div class="form-group">
              <% if food.persisted? %>
                <%= f.button t(:update), class: 'btn btn-primary' %>
              <% else %>
                <%= f.button t(:upload), class: 'btn btn-primary' %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function(){

  var srcpic = $('.picture-of-food').attr('src');
  var file_name_pic = $('.picture-of-food').attr('data-filename');
  var size_pic = $('.picture-of-food').attr('data-size');

  if($('.form-group img').hasClass('picture-of-food')){
    $("#food_picture").fileinput({
      theme: "fa",
      showUpload: false,
      initialPreview: [ "<img src="+srcpic+ " class='file-preview-image-2'>"],
      initialPreviewConfig: [{caption: file_name_pic,size: size_pic}]
    });
  }
  $("#food_picture").fileinput({
    theme: "fa",
    showUpload: false
  });

  $(document).on('click', '.fileinput-remove-button', function () {
      $('#food_picture_flag').val('2');
  });

});
</script>
